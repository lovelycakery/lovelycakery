<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>æ—¥æ›†ç®¡ç†å·¥å…· - Lovely Cakery</title>
    <link rel="stylesheet" href="assets/css/calendar-widget.css">
    <style>
        body {
            margin: 0;
            padding: 20px;
            font-family: 'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
            background: #faf8f5;
            color: #3d2817;
        }
        .manager-header {
            max-width: 1200px;
            margin: 0 auto 30px;
            padding: 20px;
            background: #ffffff;
            border-radius: 12px;
            box-shadow: 0 2px 8px rgba(61, 40, 23, 0.1);
        }
        .manager-header h1 {
            margin: 0 0 10px;
            font-size: 28px;
            color: #3d2817;
        }
        .manager-header p {
            margin: 0;
            color: #6b5d4f;
            font-size: 14px;
        }
        .calendar-container {
            max-width: 1200px;
            margin: 0 auto;
        }
        .status-message {
            max-width: 1200px;
            margin: 20px auto;
            padding: 12px 20px;
            background: #fff3cd;
            border: 1px solid #ffc107;
            border-radius: 8px;
            font-size: 14px;
            color: #856404;
        }
        .status-message.success {
            background: #d4edda;
            border-color: #28a745;
            color: #155724;
        }
        .status-message.error {
            background: #f8d7da;
            border-color: #dc3545;
            color: #721c24;
        }
    </style>
</head>
<body>
    <div class="manager-header">
        <h1 data-en="Calendar Management Tool" data-zh="æ—¥æ›†ç®¡ç†å·¥å…·">æ—¥æ›†ç®¡ç†å·¥å…·</h1>
        <p data-en="Edit calendar events and save to GitHub. Changes will be visible on the website immediately." data-zh="ç·¨è¼¯æ—¥æ›†äº‹ä»¶ä¸¦å„²å­˜åˆ° GitHubã€‚æ›´æ”¹å°‡ç«‹å³åœ¨ç¶²ç«™ä¸Šé¡¯ç¤ºã€‚">ç·¨è¼¯æ—¥æ›†äº‹ä»¶ä¸¦å„²å­˜åˆ° GitHubã€‚æ›´æ”¹å°‡ç«‹å³åœ¨ç¶²ç«™ä¸Šé¡¯ç¤ºã€‚</p>
    </div>

    <div id="statusMessage" class="status-message" style="display: none;"></div>

    <div class="calendar-container">
        <div class="calendar-header">
            <button class="calendar-nav-btn" id="prevMonth" aria-label="ä¸Šä¸€å€‹æœˆ">
                <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <path d="M15 18l-6-6 6-6"/>
                </svg>
            </button>
            <h2 class="calendar-month-year" id="monthYear"></h2>
            <button class="calendar-nav-btn" id="nextMonth" aria-label="ä¸‹ä¸€å€‹æœˆ">
                <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <path d="M9 18l6-6-6-6"/>
                </svg>
            </button>
        </div>
        
        <div class="calendar-weekdays">
            <div class="weekday" data-en="Sun" data-zh="æ—¥">æ—¥</div>
            <div class="weekday" data-en="Mon" data-zh="ä¸€">ä¸€</div>
            <div class="weekday" data-en="Tue" data-zh="äºŒ">äºŒ</div>
            <div class="weekday" data-en="Wed" data-zh="ä¸‰">ä¸‰</div>
            <div class="weekday" data-en="Thu" data-zh="å››">å››</div>
            <div class="weekday" data-en="Fri" data-zh="äº”">äº”</div>
            <div class="weekday" data-en="Sat" data-zh="å…­">å…­</div>
        </div>
        
        <div class="calendar-grid" id="calendarGrid"></div>
        
        <div class="calendar-legend">
            <div class="legend-item">
                <span class="legend-dot available"></span>
                <span class="legend-text" data-en="Available" data-zh="å¯é è¨‚">å¯é è¨‚</span>
            </div>
            <div class="legend-item">
                <span class="legend-dot unavailable"></span>
                <span class="legend-text" data-en="Unavailable" data-zh="ä¸å¯é è¨‚">ä¸å¯é è¨‚</span>
            </div>
            <div class="legend-item">
                <span class="legend-dot closed"></span>
                <span class="legend-text" data-en="Closed" data-zh="ä¼‘æ¯">ä¼‘æ¯</span>
            </div>
        </div>
    </div>
    
    <!-- ç·¨è¼¯äº‹ä»¶æ¨¡æ…‹æ¡† -->
    <div class="modal-overlay" id="eventModal">
        <div class="modal-content">
            <div class="modal-header">
                <span id="eventDateDisplay" class="form-date-display"></span>
                <button class="modal-close" id="closeModal" aria-label="é—œé–‰">
                    <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <path d="M18 6L6 18M6 6l12 12"/>
                    </svg>
                </button>
            </div>
            <div class="modal-body">
                <div class="form-group">
                    <label class="form-label" data-en="Description" data-zh="èªªæ˜">èªªæ˜</label>
                    <textarea id="eventDescription" class="form-textarea" rows="5" placeholder="è¼¸å…¥äº‹ä»¶èªªæ˜ï¼ˆé¸å¡«ï¼‰"></textarea>
                </div>
                <div class="form-group">
                    <label class="form-label" data-en="Status" data-zh="ç‹€æ…‹">ç‹€æ…‹</label>
                    <select id="eventStatus" class="form-select">
                        <option value="available" data-en="Available" data-zh="å¯é è¨‚">å¯é è¨‚</option>
                        <option value="unavailable" data-en="Unavailable" data-zh="ä¸å¯é è¨‚">ä¸å¯é è¨‚</option>
                        <option value="closed" data-en="Closed" data-zh="ä¼‘æ¯">ä¼‘æ¯</option>
                    </select>
                </div>
            </div>
            <div class="modal-footer">
                <button class="btn btn-secondary" id="deleteEvent" data-en="Delete" data-zh="åˆªé™¤">åˆªé™¤</button>
                <button class="btn btn-cancel" id="cancelEvent" data-en="Cancel" data-zh="å–æ¶ˆ">å–æ¶ˆ</button>
                <button class="btn btn-primary" id="saveEvent" data-en="Save" data-zh="å„²å­˜">å„²å­˜</button>
            </div>
        </div>
    </div>
    
    <script src="assets/js/github-config.js"></script>
    <script src="assets/js/calendar-widget.js"></script>
    <script>
        // é¡¯ç¤ºç‹€æ…‹è¨Šæ¯
        function showStatus(message, type = 'info') {
            const statusEl = document.getElementById('statusMessage');
            if (statusEl) {
                statusEl.textContent = message;
                statusEl.className = 'status-message ' + type;
                statusEl.style.display = 'block';
                setTimeout(() => {
                    statusEl.style.display = 'none';
                }, 5000);
            }
        }

        // ç›£è½ä¿å­˜æˆåŠŸäº‹ä»¶
        document.addEventListener('DOMContentLoaded', () => {
            // æª¢æŸ¥æ˜¯å¦ç‚ºæœ¬åœ°æ–‡ä»¶æ¨¡å¼
            const isLocalFile = window.location.protocol === 'file:';
            if (isLocalFile) {
                showStatus('ğŸ’¡ æœ¬åœ°æ–‡ä»¶æ¨¡å¼ï¼šè«‹ç¢ºä¿å·²é…ç½® github-config.js æ‰èƒ½è‡ªå‹•æ›´æ–°åˆ° GitHub', 'info');
            }

            // ç›£è½æ—¥æ›†åˆå§‹åŒ–å®Œæˆ
            if (window.calendarWidget) {
                // æ””æˆªä¿å­˜äº‹ä»¶ï¼Œé¡¯ç¤ºç‹€æ…‹
                const originalSaveEvents = window.calendarWidget.saveEvents;
                window.calendarWidget.saveEvents = async function() {
                    try {
                        await originalSaveEvents.call(this);
                        // å¦‚æœæˆåŠŸï¼Œæœƒç”± updateGitHubFile é¡¯ç¤ºæˆåŠŸè¨Šæ¯
                    } catch (error) {
                        showStatus('âŒ ä¿å­˜å¤±æ•—ï¼š' + error.message, 'error');
                    }
                };
            }
        });

        // æ›´æ–°èªè¨€ï¼ˆå¦‚æœéœ€è¦ï¼‰
        function updateLanguage() {
            const currentLang = localStorage.getItem('language') || 'zh';
            const elements = document.querySelectorAll('[data-en][data-zh]');
            elements.forEach(element => {
                if (currentLang === 'en') {
                    element.textContent = element.getAttribute('data-en');
                } else {
                    element.textContent = element.getAttribute('data-zh');
                }
            });
        }

        // åˆå§‹åŒ–èªè¨€
        updateLanguage();
    </script>
</body>
</html>

